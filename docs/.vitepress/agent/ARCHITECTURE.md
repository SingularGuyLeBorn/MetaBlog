# MetaUniverse Agent Runtime æ¶æ„æ–‡æ¡£

## ğŸ§¬ æ¶æ„æ¦‚è§ˆ

MetaUniverse æ˜¯ä¸€ä¸ª**äººæœºå…±ç”Ÿ**çš„ AI-Native çŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼Œä¿ç•™ VitePress çš„é™æ€åšå®¢ä¼˜åŠ¿ï¼ŒåŒæ—¶é›†æˆ Agent Runtime å®ç°å†…å®¹çš„è‡ªä¸»ç ”ç©¶ã€å†™ä½œä¸ç»´æŠ¤ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     L5: äººæœºå…±ç”Ÿç•Œé¢å±‚ (Human-AI Interface)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ BlogFrontend â”‚ â”‚ GlobalPage   â”‚ â”‚  AIChatOrb   â”‚ â”‚  Knowledge   â”‚  â”‚
â”‚  â”‚  (VitePress) â”‚ â”‚ Editor-AGI   â”‚ â”‚  (æ‚¬æµ®çƒ)    â”‚ â”‚   Graph      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     L4: æ™ºèƒ½ç¼–æ’å±‚ (AI Orchestration)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ IntentRouter â”‚ â”‚   Skill      â”‚ â”‚   State      â”‚ â”‚  Memory      â”‚  â”‚
â”‚  â”‚ (æ„å›¾è§£æ)    â”‚ â”‚   Engine     â”‚ â”‚   Machine    â”‚ â”‚  Manager     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     L3: å·¥å…·ä¸æ„ŸçŸ¥å±‚ (Tools & Senses)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   WebSearch  â”‚ â”‚   Vditor     â”‚ â”‚    Git       â”‚ â”‚   RAG        â”‚  â”‚
â”‚  â”‚   (å¤šæºæœç´¢) â”‚ â”‚   Bridge     â”‚ â”‚  Operator    â”‚ â”‚   Engine     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     L2: è¿è¡Œæ—¶ä¸è§‚å¯Ÿå±‚ (Runtime & Observability)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  GitHub      â”‚ â”‚   Logger     â”‚ â”‚   Cost       â”‚ â”‚   Health     â”‚  â”‚
â”‚  â”‚  Actions     â”‚ â”‚ (ç»“æ„åŒ–æ—¥å¿—) â”‚ â”‚   Tracker    â”‚ â”‚   Checker    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     L1: è®°å¿†å­˜å‚¨å±‚ (Memory Storage)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Content    â”‚ â”‚   History    â”‚ â”‚   Agent      â”‚ â”‚   Vector     â”‚  â”‚
â”‚  â”‚   Repo       â”‚ â”‚   Backups    â”‚ â”‚   States     â”‚ â”‚   DB         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“š å±‚çº§è¯¦è§£

### L5: äººæœºå…±ç”Ÿç•Œé¢å±‚

#### AIChatOrb
- **ä½ç½®**: å…¨å±€æ‚¬æµ®äºé¡µé¢å³ä¸‹è§’
- **åŠŸèƒ½**: æ™ºèƒ½å…¥å£ï¼Œæä¾›ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¯¹è¯ç•Œé¢
- **ç‰¹ç‚¹**: 
  - å‘¼å¸åŠ¨ç”»æŒ‡ç¤º Agent å·¥ä½œçŠ¶æ€
  - æœªè¯»æ¶ˆæ¯çº¢ç‚¹æç¤º
  - å¿«æ·æ“ä½œæŒ‰é’®ï¼ˆç»­å†™ã€æœç´¢ã€æ€»ç»“ï¼‰

#### GlobalPageEditor-AGI
- **æ¨¡å¼åˆ‡æ¢**: MANUALï¼ˆäººå·¥ï¼‰/ COLLABï¼ˆåä½œï¼‰/ AGENTï¼ˆæ‰˜ç®¡ï¼‰
- **è¡Œå†…å»ºè®®**: ç±»ä¼¼ GitHub Copilot çš„æ™ºèƒ½è¡¥å…¨
- **ä¸Šä¸‹æ–‡æŒ‡ç¤ºå™¨**: æ˜¾ç¤ºå…³è”æ–‡ç« ã€å®ä½“ã€Token ä½¿ç”¨æƒ…å†µ

### L4: æ™ºèƒ½ç¼–æ’å±‚

#### IntentRouter
- åŸºäºè§„åˆ™çš„æ„å›¾è§£æ
- æ”¯æŒ 8 ç§æ ¸å¿ƒæ„å›¾ç±»å‹
- ä½ç½®ä¿¡åº¦æ—¶è¯¢é—®ç”¨æˆ·ç¡®è®¤

#### SkillEngine
- 7 ä¸ªå†…ç½®æŠ€èƒ½ï¼šWriteArticleã€EditContentã€ResearchWebã€UpdateGraphã€CodeExplainã€AnswerQuestionã€Summarize
- å¯æ‰©å±•çš„æŠ€èƒ½æ³¨å†Œæœºåˆ¶
- ä¸­é—´ä»¶æ”¯æŒ

#### StateMachine
- 8 ç§ Agent çŠ¶æ€ç®¡ç†
- æ–­ç‚¹ç»­ä½œæ”¯æŒï¼ˆcheckpointï¼‰
- çŠ¶æ€è½¬æ¢éªŒè¯

### L3: å·¥å…·ä¸æ„ŸçŸ¥å±‚

- **WebSearch**: å¤šæºæœç´¢ï¼ˆArxivã€Googleã€GitHubï¼‰
- **Vditor Bridge**: ä¸ç¼–è¾‘å™¨çš„åŒå‘é€šä¿¡
- **Git Operator**: åŒºåˆ†äººå·¥å’Œ Agent çš„ Git æäº¤
- **RAG Engine**: åŸºäºå‘é‡çš„çŸ¥è¯†æ£€ç´¢

### L2: è¿è¡Œæ—¶ä¸è§‚å¯Ÿå±‚

#### Logger
- ç»“æ„åŒ–æ—¥å¿—è®°å½•
- æŒ‰ä»»åŠ¡ç­›é€‰
- æ—¶é—´çº¿è§†å›¾

#### CostTracker
- Token ä½¿ç”¨è¿½è¸ª
- æˆæœ¬ä¼°ç®—
- é¢„ç®—è­¦å‘Š

### L1: è®°å¿†å­˜å‚¨å±‚

```
docs/.vitepress/
â”œâ”€â”€ memory/
â”‚   â”œâ”€â”€ tasks/        # ä»»åŠ¡å†å²
â”‚   â”œâ”€â”€ entities/     # çŸ¥è¯†å®ä½“
â”‚   â”œâ”€â”€ context/      # çŸ­æœŸè®°å¿†
â”‚   â””â”€â”€ skills/       # æŠ€èƒ½æ¨¡æ¿
â”œâ”€â”€ history/          # Git å†å²å¤‡ä»½
â””â”€â”€ cache/            # RAG å‘é‡ç´¢å¼•
```

## ğŸ”Œ API è·¯ç”±

| è·¯ç”± | æ–¹æ³• | æè¿° |
|------|------|------|
| `/api/files/read` | GET | è¯»å–æ–‡ä»¶ï¼ˆäººå·¥æ“ä½œï¼‰ |
| `/api/files/save` | POST | ä¿å­˜æ–‡ä»¶ï¼ˆäººå·¥æ“ä½œï¼‰ |
| `/api/agent/task` | POST | Agent ä»»åŠ¡æäº¤ |
| `/api/agent/context/init` | POST | åˆå§‹åŒ– Agent ä¸Šä¸‹æ–‡ |
| `/api/agent/task/status` | GET | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ |
| `/api/git/log` | GET | è·å– Git æ—¥å¿— |

## ğŸ”„ å·¥ä½œæµç¤ºä¾‹

### åœºæ™¯ 1: äººå·¥å†™ä½œ + AI å»ºè®®ï¼ˆCOLLAB æ¨¡å¼ï¼‰

1. ç”¨æˆ·è¿›å…¥ç¼–è¾‘é¡µï¼Œé»˜è®¤ MANUAL æ¨¡å¼
2. ç‚¹å‡»"AI åä½œ"åˆ‡æ¢ä¸º COLLAB æ¨¡å¼
3. Agent åˆ†æå½“å‰æ®µè½ï¼Œæ£€æµ‹ WikiLinks
4. å‘ç°å­¤ç«‹èŠ‚ç‚¹ï¼Œå»ºè®®åˆ›å»ºç›¸å…³æ–‡ç« 
5. ç”¨æˆ·æ¥å—å»ºè®®ï¼ŒAgent è°ƒç”¨ WriteArticle æŠ€èƒ½
6. è‡ªåŠ¨ç”Ÿæˆæ–‡ç« å¹¶æ’å…¥é“¾æ¥

### åœºæ™¯ 2: Agent æ·±åº¦ç ”ç©¶

1. ç”¨æˆ·é€šè¿‡ ChatOrb è§¦å‘ç ”ç©¶æŒ‡ä»¤
2. Agent åˆ›å»ºä»»åŠ¡å¹¶è®°å½•åˆ° history/agent/
3. æœç´¢ Arxivã€Google ç­‰å¤šä¸ªæ¥æº
4. ç”Ÿæˆç»¼è¿°æ–‡ç« ï¼ŒGit æäº¤æ ‡è®°ä¸º Agent
5. ç”¨æˆ·åœ¨ HistoryViewer æŸ¥çœ‹å®Œæ•´æ€è€ƒé“¾

## ğŸ› ï¸ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°æŠ€èƒ½

```typescript
import { Skill } from './core/types'

const MySkill: Skill = {
  name: 'MySkill',
  description: 'æˆ‘çš„è‡ªå®šä¹‰æŠ€èƒ½',
  intentPattern: /åŒ¹é…æ¨¡å¼/,
  requiredParams: ['param1'],
  optionalParams: ['param2'],
  handler: async (ctx, params) => {
    // å®ç°é€»è¾‘
    return {
      success: true,
      data: { result: '...' },
      tokensUsed: 100,
      cost: 0.002
    }
  }
}

agent.registerSkill(MySkill)
```

### è‡ªå®šä¹‰æ„å›¾

```typescript
intentRouter.registerIntent({
  type: 'MY_INTENT',
  patterns: [/æ­£åˆ™è¡¨è¾¾å¼/],
  description: 'æè¿°',
  parameterExtractors: {
    param: (match) => match[1]
  }
})
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **æ„å›¾è§£æ**: < 100ms
- **æŠ€èƒ½æ‰§è¡Œ**: å–å†³äºå¤–éƒ¨ API
- **RAG æ£€ç´¢**: < 50msï¼ˆæœ¬åœ°ç¼“å­˜ï¼‰
- **å†…å­˜å ç”¨**: < 50MB

## ğŸ” å®‰å…¨è€ƒè™‘

1. **Git æäº¤åŒºåˆ†**: Agent æäº¤ä½¿ç”¨ç‰¹å®šæ ¼å¼ï¼Œä¾¿äºå®¡è®¡
2. **æˆæœ¬é™åˆ¶**: æ¯æ—¥é¢„ç®—é™åˆ¶ï¼Œé˜²æ­¢æ„å¤–è¶…æ”¯
3. **è¾“å…¥éªŒè¯**: æ‰€æœ‰å‚æ•°ç»è¿‡éªŒè¯å’Œæ¸…ç†
4. **æ²™ç®±æ‰§è¡Œ**: æŠ€èƒ½æ‰§è¡Œåœ¨å—é™ç¯å¢ƒä¸­

## ğŸš€ æœªæ¥è§„åˆ’

- [ ] çœŸæ­£çš„ LLM é›†æˆï¼ˆOpenAI / Anthropicï¼‰
- [ ] å‘é‡æ•°æ®åº“å­˜å‚¨ï¼ˆPinecone / Weaviateï¼‰
- [ ] å¤š Agent åä½œ
- [ ] è‡ªåŠ¨åŒ–å·¥ä½œæµç¼–æ’
- [ ] å¯è§†åŒ–çŸ¥è¯†å›¾è°±ç¼–è¾‘å™¨

---

> "ä»æ•°å­—å­ªç”Ÿåˆ°æ•°å­—ç”Ÿå‘½ä½“"
> 
> â€” MetaUniverse æ¶æ„å“²å­¦
